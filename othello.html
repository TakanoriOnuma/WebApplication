<!DOCTYPE html>
<html lang="ja">
<head>
<title>オセロ</title>
<meta charset="UTF-8" />
<script language="JavaScript" src="player.js"></script>
<script language="JavaScript" src="othello_process.js"></script>
<script language="JavaScript">
//*******************************************************************
//**　グローバル変数定義（どの関数からも参照可能） **
//*******************************************************************
var game_speed = 500;       // ゲームスピード

var black = 1;      // 黒
var white = 2;      // 白

var player1 = new Human(black - 1);
var player2 = new Human(white - 1);
var now_player = player1;       // 今プレイするプレイヤー（石を置くプレイヤー）

var table = new Array(); 
for (i = 0; i < 64; i++) {
    table[i] = 0;
};
// 初期の配置
table[27] = table[36] = white;
table[28] = table[35] = black;
// 画像の設定
var images = new Array();
images[0] = new Image(); images[0].src = "images/background.gif";
images[1] = new Image(); images[1].src = "images/black.gif";
images[2] = new Image(); images[2].src = "images/white.gif";
images[3] = new Image(); images[3].src = "images/reverse.gif";

// どっちの手かを文字列で返す
function get_turn_str(turn) {
    return (turn == black - 1) ? "黒" : "白";
}

//*******************************************************************
//** 開始(startは使えないため、g_startにした) **
//*******************************************************************
function g_start() {
    alert("start");
    game_speed = document.form1.game_speed.value;
    // スピードの範囲を0～9000に収める
    if (game_speed < 0) {
        game_speed = 0;
    };
    if (game_speed > 9000) {
        game_speed = 9000;
    };
    main();            // メインへ飛ぶ
}

//*******************************************************************
//** メイン **
//*******************************************************************
function main() {
    document.form1.info.value = get_turn_str(now_player.color) + "の番";
    var black_stone_num = white_stone_num = 0;
    for (var i = 0; i <= 63; i++) {
        if (table[i] == black) {
            black_stone_num++;
        };
        if (table[i] == white) {
            white_stone_num++;
        };
    };
    document.form1.black.value = black_stone_num;
    document.form1.white.value = white_stone_num;

    now_player.input();
}


//*******************************************************************
//** (i % 8, i / 8)に石を置く **
//*******************************************************************
function input(i) {
    // プレイヤーが人間か
    if (now_player instanceof Human) {
        now_player.self_input(i);
    }
};

// 次の処理（次のプレイヤーに移る）
function next() {
    // 次のプレイヤーへ移る
    now_player = (now_player == player1) ? player2 : player1;
    main();     // メインに戻る
}

//*******************************************************************
//** ロジック終了 **
//*******************************************************************
</script>

</head>

<body bgcolor="#eeffee" text="#111122">
<div align="center">
<form name="form1"><font size="3" font color="#000000">
<pre>実行時間(mmsec)（0-9000の範囲）<input type="text" size="4" name="game_speed" value="1000">
黒<input type="text" size="2" name="black" value="2">　　白<input type="text" size="2" name="white" value="2">
<br />
<input type="text" size="36" name="info" value="開始ボタンを押してください。">
</pre>
</font>
</form>
</div>

<br />
<div align="center"><input type="button" value="スタート" onClick="g_start()"></div>
<br />
<table align="center" border=3 bgcolor="#006633">
<tr><td>
<script language="JavaScript">
var i;
// オセロの画像を設置
for (i = 0; i < 64; i++) {
    document.write('<a href="JavaScript:input(',i,')"><img src="images/background.gif" width=38 height=38 border=0></a>');
    if(i % 8 == 7) {
        document.write('<br />');
    };
};
// 初期の白と黒の石を設置
document.images[27].src = images[white].src;
document.images[28].src = images[black].src;
document.images[35].src = images[black].src;
document.images[36].src = images[white].src;
</script>
</td></tr>
</table>
</body>
</html>